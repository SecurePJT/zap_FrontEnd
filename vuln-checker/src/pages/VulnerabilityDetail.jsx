import React from 'react';
import { useParams, Link } from 'react-router-dom';

const exampleCodes = {
  'Missing Anti-clickjacking Header': {
    example: `<iframe src="https://example.com"></iframe>`,
    fix: `res.setHeader("X-Frame-Options", "DENY");`
  },
  'Strict-Transport-Security Header Not Set': {
    example: `// HSTS 미설정`,
    fix: `res.setHeader("Strict-Transport-Security", "max-age=31536000; includeSubDomains");`
  },
  'Content Security Policy (CSP) Header Not Set': {
    example: `// CSP 없음`,
    fix: `res.setHeader("Content-Security-Policy", "default-src 'self'");`
  },
  'X-Content-Type-Options Header Missing': {
    example: `// x-content-type-options 누락`,
    fix: `res.setHeader("X-Content-Type-Options", "nosniff");`
  },
  'Re-examine Cache-control Directives': {
    example: `Cache-Control: public, max-age=600`,
    fix: `Cache-Control: no-store, no-cache, must-revalidate`
  },
  'Retrieved from Cache': {
    example: `Age: 0`,
    fix: `Cache-Control: no-store`
  },
  'SQL Injection': {
    example: `
const userInput = req.query.id;
const query = "SELECT * FROM users WHERE id = " + userInput;
// 예: id=1 OR 1=1 → 모든 사용자 노출
db.query(query, function(err, result) {
  // 처리 로직
});
    `.trim(),
    fix: `
const userInput = req.query.id;
const query = "SELECT * FROM users WHERE id = ?";
db.query(query, [userInput], function(err, result) {
  // 처리 로직
});
    `.trim()
  }
};

export default function VulnerabilityDetail() {
  const { name } = useParams();
  const decodedName = decodeURIComponent(name);
  const detail = exampleCodes[decodedName];

  return (
    <div className="max-w-3xl mx-auto p-6">
      <Link to="/" className="text-blue-500 underline mb-4 inline-block">← 목록으로</Link>
      <h1 className="text-2xl font-bold mb-4">{decodedName}</h1>

      {detail ? (
        <div>
          <div className="mb-4">
            <h2 className="font-semibold">예시 코드</h2>
            <pre className="bg-gray-100 p-3 rounded text-sm overflow-x-auto whitespace-pre-wrap">
              {detail.example}
            </pre>
          </div>
          <div>
            <h2 className="font-semibold">보완 코드</h2>
            <pre className="bg-green-100 p-3 rounded text-sm overflow-x-auto whitespace-pre-wrap">
              {detail.fix}
            </pre>
          </div>
        </div>
      ) : (
        <p className="text-red-500">예시 코드 정보가 없습니다.</p>
      )}
    </div>
  );
}
